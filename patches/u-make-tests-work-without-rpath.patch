Author: Chris Coulson <chris.coulson@canonical.com>
Forwarded: TODO
diff --git a/src/test/run-make/issue-38237/Makefile b/src/test/run-make/issue-38237/Makefile
index 855d958b34..56848aa180 100644
--- a/src/test/run-make/issue-38237/Makefile
+++ b/src/test/run-make/issue-38237/Makefile
@@ -7,5 +7,5 @@ all:
 else
 all:
 	$(RUSTC) foo.rs; $(RUSTC) bar.rs
-	$(RUSTDOC) baz.rs -L $(TMPDIR) -o $(TMPDIR)
+	$(HOST_RPATH_ENV) '$(RUSTDOC)' baz.rs -L $(TMPDIR) -o $(TMPDIR)
 endif
diff --git a/src/test/run-make/issue-40535/Makefile b/src/test/run-make/issue-40535/Makefile
index 7d513a86a7..7f8662c897 100644
--- a/src/test/run-make/issue-40535/Makefile
+++ b/src/test/run-make/issue-40535/Makefile
@@ -1,11 +1,13 @@
+-include ../tools.mk
+
 # The ICE occurred in the following situation:
 # * `foo` declares `extern crate bar, baz`, depends only on `bar` (forgetting `baz` in `Cargo.toml`)
 # * `bar` declares and depends on `extern crate baz`
 # * All crates built in metadata-only mode (`cargo check`)
 all:
 	# cc https://github.com/rust-lang/rust/issues/40623
-	$(RUSTC) baz.rs --emit=metadata --out-dir=$(TMPDIR)
-	$(RUSTC) bar.rs --emit=metadata --extern baz=$(TMPDIR)/libbaz.rmeta --out-dir=$(TMPDIR)
-	$(RUSTC) foo.rs --emit=metadata --extern bar=$(TMPDIR)/libbar.rmeta --out-dir=$(TMPDIR) 2>&1 | \
+	$(BARE_RUSTC) baz.rs --emit=metadata --out-dir=$(TMPDIR)
+	$(BARE_RUSTC) bar.rs --emit=metadata --extern baz=$(TMPDIR)/libbaz.rmeta --out-dir=$(TMPDIR)
+	$(BARE_RUSTC) foo.rs --emit=metadata --extern bar=$(TMPDIR)/libbar.rmeta --out-dir=$(TMPDIR) 2>&1 | \
 	grep -vq "unexpectedly panicked"
 	# ^ Succeeds if it doesn't find the ICE message
